# 딥러닝 기반 멀티모달 강화학습 트레이딩 시스템: 캔들차트와 뉴스 감성의 통합적 접근

## 국문초록

본 연구는 변동성이 높은 암호화폐 시장에서 안정적이고 높은 수익을 목표로 하는 딥러닝 기반 멀티모달 강화학습 트레이딩 시스템을 제안한다. 제안 시스템은 전통적인 기술적 분석 지표로 활용되는 캔들차트의 시각적 패턴 정보와, 시장의 심리적 요인을 반영하는 뉴스 기사의 감성 정보를 통합적으로 활용한다. 캔들스틱 차트 이미지를 CNN 기반 모델로 분석하고, DeepSeek R1(32B) 모델을 활용하여 뉴스 기사의 감성을 평가한 후, 크로스 모달 어텐션 메커니즘을 통해 두 정보를 효과적으로 융합한다. 또한 우선순위 경험 재생을 적용한 강화학습 앙상블 시스템을 도입하여 다양한 시장 상황에 대응할 수 있는 트레이딩 정책을 학습한다. 2023년 암호화폐 시장 데이터를 활용한 백테스팅 결과, 제안 시스템은 단일 모달리티 모델과 기존 트레이딩 전략보다 우수한 성능을 보였다. 구체적으로 156.8%의 연간 수익률, 2.45의 샤프 비율, 68.5%의 거래 승률을 달성하였으며, 거래 비용을 고려한 실전 환경에서도 강건한 성능을 유지하였다. 이 연구는 멀티모달 학습과 강화학습을 결합한 트레이딩 시스템이 복잡한 금융 시장에서 효과적으로 활용될 수 있음을 보여준다.

**키워드**: 멀티모달 딥러닝, 강화학습, 트레이딩 시스템, 캔들스틱 차트, 감성 분석, DeepSeek, 암호화폐

## 1. 서론

금융 시장, 특히 암호화폐 시장은 높은 변동성과 복잡한 패턴을 보이며, 이러한 시장에서 안정적으로 수익을 창출하기 위해서는 다양한 정보 소스를 활용한 종합적인 의사결정이 중요하다. 전통적인 트레이딩 시스템은 대부분 단일 유형의 데이터(기술적 지표, 가격 패턴 등)에 의존하거나, 복수의 데이터를 활용하더라도 단순한 규칙 기반의 통합 방식을 사용했다. 이러한 접근 방식은 시장의 복잡성과 역동성을 충분히 반영하지 못하는 한계가 있다.

본 연구는 캔들스틱 차트의 시각적 패턴과 뉴스 기사의 감성 정보를 딥러닝 기반의 멀티모달 방식으로 통합하고, 강화학습을 활용하여 최적의 트레이딩 정책을 학습하는 시스템을 제안한다. 특히 최신 대형 언어 모델인 DeepSeek R1(32B)을 활용하여 복잡한 금융 뉴스의 시장 영향을 분석하고, 어텐션 기반 CNN으로 캔들스틱 차트의 중요 패턴을 인식한다. 이 두 정보는 크로스 모달 어텐션 메커니즘을 통해 효과적으로 융합되며, 다양한 강화학습 알고리즘을 앙상블하여 최종 트레이딩 결정을 내린다.

이러한 접근 방식은 각 데이터 소스의 장점을 최대한 활용하면서도, 데이터 간의 상호작용을 고려한 통합적 판단을 가능하게 한다. 본 연구의 주요 기여는 다음과 같다:

1. 캔들스틱 차트와 뉴스 데이터를 효과적으로 통합하는 크로스 모달 어텐션 메커니즘 제안
2. DeepSeek R1(32B) 모델을 활용한 금융 뉴스의 심층적 감성 분석 프레임워크 개발
3. 우선순위 경험 재생을 적용한 강화학습 앙상블 시스템을 통한 최적 트레이딩 정책 학습
4. 다양한 시장 조건에서의 포괄적인 실증 분석 및 성능 평가

## 2. 관련 연구

### 2.1 딥러닝 기반 금융 시계열 분석

금융 시계열 데이터 분석에는 전통적으로 ARIMA, GARCH 등의 통계적 모델이 널리 사용되어 왔다. 최근에는 딥러닝 기술의 발전으로 RNN, LSTM, Transformer 등의 신경망 모델이 시계열 데이터 분석에 활발히 적용되고 있다. Zhang et al.(2020)은 LSTM과 어텐션 메커니즘을 결합하여 주가 예측 성능을 향상시켰으며, Li et al.(2019)은 Wavelet Transform과 CNN을 결합한 하이브리드 모델을 제안하였다.

### 2.2 캔들스틱 차트 패턴 인식

캔들스틱 차트는 가격의 시가, 고가, 저가, 종가를 시각적으로 표현한 금융 차트로, 다양한 패턴이 미래 가격 방향의 지표로 활용된다. 전통적으로는 전문가의 경험적 지식에 기반한 패턴 인식이 이루어졌으나, 최근에는 딥러닝 기술을 활용한 자동화된 패턴 인식 연구가 증가하고 있다. Chen et al.(2021)은 CNN을 활용하여 15개의 주요 캔들스틱 패턴을 높은 정확도로 인식하는 모델을 개발하였으며, Hu et al.(2018)은 CNN과 RNN을 결합하여 시간적 의존성을 고려한 패턴 인식 시스템을 제안하였다.

### 2.3 금융 뉴스 감성 분석

금융 뉴스는 시장 참여자들의 심리와 기대를 반영하며, 이는 시장의 단기적 움직임에 중요한 영향을 미친다. 전통적인 감성 분석 방법으로는 사전 기반 접근법과 기계학습 기반 접근법이 있다. 최근에는 BERT, GPT 등의 대형 언어 모델을 활용한 감성 분석 연구가 활발히 진행되고 있다. Araci(2019)는 FinBERT 모델을 통해 금융 도메인 특화 감성 분석의 정확도를 향상시켰으며, Yang et al.(2020)은 뉴스 헤드라인의 감성을 분석하여 주가 예측에 활용하는 방법을 제안하였다.

### 2.4 강화학습 기반 트레이딩 시스템

강화학습은 환경과의 상호작용을 통해 최적의 정책을 학습하는 방법으로, 불확실성이 높은 금융 시장에서의 의사결정에 적합하다. Xiong et al.(2018)은 Deep Q-Network(DQN)을 활용한 트레이딩 시스템을 제안하였으며, Jiang et al.(2017)은 CNN을 활용한 상태 표현과 함께 강화학습 기반의 포트폴리오 관리 시스템을 개발하였다. 최근에는 Huang et al.(2020)이 우선순위 경험 재생을 적용한 Double DQN을 트레이딩에 활용하여 성능을 향상시켰다.

### 2.5 멀티모달 학습

멀티모달 학습은 다양한 유형의 데이터(이미지, 텍스트, 오디오 등)를 통합하여 학습하는 방법으로, 각 모달리티의 장점을 살리면서 부족한 부분을 보완할 수 있다. 금융 분야에서도 멀티모달 접근법의 중요성이 증가하고 있으며, Chen et al.(2022)은 재무제표 데이터와 뉴스 텍스트를 결합한 주가 예측 모델을 제안하였다. 또한 Lu et al.(2019)은 시각적 데이터와 텍스트 데이터를 효과적으로 통합하기 위한 크로스 모달 어텐션 메커니즘을 제안하였다.

## 3. 시스템 아키텍처

본 연구에서 제안하는 멀티모달 강화학습 트레이딩 시스템은 다음 7가지 주요 컴포넌트로 구성된다.

### 3.1 데이터 소스 레이어

#### 3.1.1 캔들스틱 데이터 소스
- 바이낸스/트레이딩뷰에서 제공하는 OHLCV(시가, 고가, 저가, 종가, 거래량) 시계열 데이터를 활용한다.
- 다양한 시간대(1H, 4H, 1D)의 가격 패턴 데이터를 포함하여 다중 시간대 분석이 가능하도록 한다.
- 실시간 및 과거 시장 데이터를 통합하여 모델의 학습 및 예측에 활용한다.

#### 3.1.2 뉴스 기사 데이터 소스
- 암호화폐 관련 뉴스 API 및 RSS 피드에서 데이터를 수집한다.
- 시장 감성 및 주요 이벤트 정보를 획득하여 시장의 심리적 요인을 분석한다.
- 금융 뉴스, 소셜 미디어 감성 분석, 공식 발표 등 다양한 텍스트 소스를 통합한다.

### 3.2 이미지 기반 분석 모듈

캔들스틱 데이터를 시각적 패턴으로 처리하는 딥러닝 모듈로, 다음과 같은 세부 과정을 포함한다:

- **캔들스틱 차트 생성 [224,224,3]**: 시계열 데이터를 224x224 픽셀 크기의 RGB 이미지로 변환하여 시각적 패턴 인식에 최적화한다.
- **Attention-based CNN**: 컨볼루션 신경망(CNN)과 어텐션 메커니즘을 결합하여 지지선, 저항선, 헤드앤숄더 등 중요한 시각적 패턴에 집중한다.
- **CBAM(Convolutional Block Attention Module)**: 중요 시각 영역에 가중치를 부여하여 노이즈를 감소시키고, 현재 시장 상태와 거래 비용을 고려한 특징 추출이 가능하다.
- **특징 벡터 출력**: 차트 패턴을 512 차원의 특징 벡터로 압축하여 다음 단계의 멀티모달 융합을 위한 최적 표현을 생성한다.

### 3.3 DeepSeek-R1 뉴스 분석 모듈

뉴스 텍스트 데이터를 분석하는 대규모 언어 모델 기반 모듈로, 다음과 같은 세부 과정을 포함한다:

- **뉴스 데이터 전처리**: 토큰화, 불용어 제거, 핵심 추출 등의 NLP 전처리 작업을 수행하고, 금융 도메인 특화 용어를 처리한다.
- **DeepSeek-R1 32B 모델**: 320억 파라미터 규모의 대형 언어 모델을 활용하여 Chain-of-Thought 추론 방식으로 복잡한 금융 정보를 분석한다.
- **시장 영향 점수 분석**: 뉴스가 시장에 미치는 영향을 -1(매우 부정적)에서 1(매우 긍정적) 사이로 수치화하여 미래 가격 방향성을 예측한다.
- **특징 벡터 출력**: 뉴스 분석 결과를 256 차원의 특징 벡터로 압축하여 다음 단계의 멀티모달 융합에 활용한다.

### 3.4 멀티모달 특징 융합 레이어

이미지와 텍스트 데이터를 통합하는 핵심 레이어로, 다음과 같은 세부 과정을 포함한다:

- **크로스 모달 어텐션**: 이미지 특징과 뉴스 특징 간의 연관성을 학습하여 시각 데이터와 텍스트 데이터 간의 상호작용을 모델링한다. 수식적으로는 A_img ⊗ softmax(V_F_img ⊙ F_news^T)로 표현된다.
- **컨텍스트 게이팅**: 시장 상황에 따라 이미지/뉴스 데이터의 중요도를 동적으로 조절한다. 예를 들어, 고변동성 시기에는 뉴스 가중치를 증가시키고, 안정적 시기에는 차트 패턴에 집중한다. 수식적으로는 G_img = σ(W_g ⊙ F_img / A_img)로 표현된다.
- **통합 벡터 출력**: 두 모달리티의 정보를 융합하여 768 차원의 고차원 표현을 생성하고, 이를 강화학습의 입력으로 활용한다.

### 3.5 우선순위 경험 재생 시스템

강화학습의 효율성을 크게 향상시키는 핵심 개선 요소로, 다음과 같은 세부 과정을 포함한다:

- **(Dueling)DQN 학습 프로세스**: 경험 데이터(s, a, r, s', done)를 저장 및 처리하고, Replay Buffer를 통한 경험 재생으로 학습을 안정화한다. Target Network와 Behavior Network의 분리를 통해 학습 안정성을 확보한다.
- **SumTree 구조**: 효율적인 우선순위 기반 샘플링을 위한 이진 트리 구조를 사용한다. 노드 값은 하위 노드의 우선순위 합계를 표현하며, O(log n) 시간 복잡도로 빠른 샘플링이 가능하다.
- **TD 오차 기반 우선순위**: 예측과 실제 값의 차이가 큰 경험에 높은 우선순위를 부여하여 학습 효율성을 향상시킨다. 수식적으로는 priority = (|TD_error| + ε)^α로 표현되며, 중요도 샘플링 보정을 통해 샘플링 편향을 해결한다.

### 3.6 강화학습 에이전트 앙상블

다양한 강화학습 알고리즘과 앙상블 의사결정 시스템으로, 다음과 같은 세부 과정을 포함한다:

- **DQN 에이전트**: Double DQN 구조로 Q-값 과대평가 문제를 해결하고, 우선순위 경험 재생을 통해 학습 효율성을 향상시킨다. 이산적인 행동 공간(매수/매도/홀딩)에 최적화되어 있다.
- **PPO 에이전트**: Actor-Critic 구조로 정책과 가치 함수를 동시에 학습하고, 클립 서로게이트 목적함수를 통해 안정적인 정책 업데이트를 수행한다. 연속적인 행동 공간(포지션 크기 등)에 효과적이다.
- **앙상블 결합**: 샤프 비율 기반으로 에이전트를 선택하고, 가중 투표 메커니즘을 통해 다양한 에이전트의 예측을 통합한다. 상위 3개 에이전트를 선택하여 최적의 의사결정을 도출한다.
- **다중 에이전트 시스템**: 다양한 초기화 조건과 하이퍼파라미터로 여러 에이전트를 학습시키고, 각 에이전트가 서로 다른 시장 상황에 특화되도록 발전시킨다.

### 3.7 예측 및 의사결정

최종 트레이딩 액션과 리스크 관리를 담당하는 단계로, 다음과 같은 세부 과정을 포함한다:

- **매수/매도/홀딩 결정**: 앙상블 에이전트의 가중 투표 결과에 기반하여 포지션 방향을 결정하고, 확률적 예측과 신뢰도 수준을 고려한다.
- **포지션 크기 최적화**: 리스크 관리 및 자본 할당을 최적화하고, 현재 시장 변동성과 예측 신뢰도에 따라 포지션 크기를 조절한다.

## 4. 실험 및 결과

### 4.1 데이터셋 및 실험 설정

실험에 사용된 데이터셋은 다음과 같다:
- 캔들 차트 이미지(224X224): 총 369,456장 (2021-10-12 ~ 2023-12-19)
- 암호화폐 뉴스 기사: 총 31,038개 (2021-10-12 ~ 2023-12-19)

실험은 다음과 같이 설정하였다:
- 학습 데이터: 2020-01-01 ~ 2022-12-31
- 테스트 데이터: 2023-01-01 ~ 2023-12-31
- 초기 자본: $10,000
- 거래 단위: 0.1 BTC

### 4.2 성능 평가 지표

모델의 성능을 평가하기 위해 다음과 같은 지표를 사용하였다:
- 총 수익률: 초기 자본 대비 최종 자본의 증가율
- 샤프 비율(Sharpe Ratio): 리스크 대비 수익률
- 소르티노 비율(Sortino Ratio): 하방 리스크 대비 수익률
- 최대 손실폭(Maximum Drawdown): 최고점에서 최저점까지의 최대 손실률
- 승률: 수익이 발생한 거래의 비율

### 4.3 비교 모델

제안 모델의 성능을 다음 모델들과 비교하였다:
- Buy & Hold 전략: 초기에 매수하여 테스트 기간 동안 보유
- 단일 모달리티 모델: 캔들스틱 차트만 사용한 모델
- VADER 감성 분석 모델: 기존 감성 분석 도구를 활용한 모델
- 규칙 기반 트레이딩 시스템: 전통적인 기술적 지표 기반 모델

### 4.4 실험 결과

#### 4.4.1 수익률 비교
- DeepSeek R1(32b) 모델: 156.8% 수익률
- 기존 VADER 감성분석: 89.3% 수익률
- Buy & Hold 전략: 42.1% 수익률

#### 4.4.2 리스크 조정 수익률
- Sharpe Ratio: 2.45
- Sortino Ratio: 3.12
- 최대 낙폭: 18.7%

#### 4.4.3 거래 통계
- 승률: 68.5%
- 평균 수익: 2.3%
- 평균 손실: 1.1%
- 손익비: 2.09

#### 4.4.4 시간대별 성능 분석
- 1시간봉: 142.3% 수익률
- 4시간봉: 168.9% 수익률
- 일봉: 156.8% 수익률

#### 4.4.5 감성 분석 정확도
- 긍정 감성 정확도: 82.3%
- 부정 감성 정확도: 79.8%
- 중립 감성 정확도: 75.6%
- 전체 정확도: 79.2%

#### 4.4.6 Single vs Multimodal 모델 성능 비교
멀티모달 모델(캔들+뉴스)이 단일 모달(캔들만 사용) 모델에 비해 일관되게 우수한 성능을 보였다. 특히 시장의 급격한 변동이 있는 구간에서 뉴스 데이터가 추가된 멀티모달 모델이 더 빠르게 적응하는 것으로 나타났다.

#### 4.4.7 강화학습 알고리즘 비교
DQN, DuelDQN, PPO 각각의 단일/멀티모달 누적 수익률을 비교한 결과, DuelDQN이 가장 높은 성능을 보였으며, 앙상블 방식이 모든 단일 알고리즘보다 우수한 성능을 달성했다.

#### 4.4.8 거래 비용 고려 시 성능
거래비용(수수료, 슬리피지)을 고려한 후에도 제안 시스템은 여전히 높은 수익률을 유지했다. 이는 모델이 불필요한 거래를 최소화하고 중요한 시점에만 포지션을 변경하는 효율적인 전략을 학습했음을 보여준다.

### 4.5 모델 해석성 분석

#### 4.5.1 특징 중요도 분석
멀티모달 모델의 입력 변수별 중요도를 분석한 결과, 캔들스틱 패턴과 관련된 특징이 45%, 뉴스 감성 관련 특징이 35%, 시장 상태 관련 특징이 20%의 중요도를 보였다. 이는 시각적 패턴과 뉴스 감성이 모두 트레이딩 결정에 중요한 영향을 미친다는 것을 보여준다.

#### 4.5.2 어블레이션 스터디
입력 변수별 제거 실험을 통해 각 컴포넌트의 기여도를 분석했다. 뉴스 감성 정보를 제거했을 때 수익률이 28% 감소했으며, 캔들스틱 패턴 정보를 제거했을 때는 43% 감소했다. 이는 두 모달리티가 모두 성능에 중요한 기여를 한다는 것을 보여준다.

## 5. 결론 및 향후 연구

본 연구에서는 캔들스틱 차트와 뉴스 데이터를 멀티모달 방식으로 통합하고 강화학습을 활용하여 최적의 트레이딩 정책을 학습하는 시스템을 제안했다. 실험 결과, 제안 시스템은 기존의 단일 모달리티 모델이나 규칙 기반 트레이딩 시스템보다 우수한 성능을 보였으며, 다양한 시장 상황에서도 안정적인 성능을 유지했다.

주요 기여는 다음과 같다:
1. 캔들스틱 차트의 시각적 패턴과 뉴스 감성 정보를 효과적으로 통합하는 크로스 모달 어텐션 메커니즘을 제안했다.
2. DeepSeek R1(32B) 모델을 활용하여 복잡한 금융 뉴스의 시장 영향을 심층적으로 분석했다.
3. 우선순위 경험 재생을 적용한 강화학습 앙상블 시스템을 통해 최적의 트레이딩 정책을 학습했다.
4. 다양한 시장 조건에서의 포괄적인 실증 분석을 통해 제안 시스템의 우수성을 검증했다.

향후 연구 방향은 다음과 같다:
1. 소셜 미디어 데이터, 온체인 지표 등 추가적인 데이터 소스를 통합하여 더욱 포괄적인 시장 분석을 수행한다.
2. 시장 레짐(추세, 횡보, 변동성 등)을 자동으로 감지하고 각 레짐에 최적화된 전략을 적용하는 방법을 연구한다.
3. 멀티 에이전트 강화학습(MARL)을 활용하여 다양한 에이전트가 협력하는 시스템을 개발한다.
4. 더 긴 기간의 실험과 다양한 암호화폐, 주식 등에 대한 적용을 통해 제안 시스템의 일반화 능력을 검증한다.

## 참고문헌

1. Araci, D. (2019). FinBERT: Financial sentiment analysis with pre-trained language models. arXiv preprint arXiv:1908.10063.
2. Chen, J., Chen, Z., Li, F., & Tao, D. (2021). Neural candlestick pattern recognition: A deep learning approach for financial pattern recognition. IEEE Transactions on Neural Networks and Learning Systems, 32(5), 2237-2250.
3. Chen, L., Zhang, Y., & Ye, Z. (2022). Multimodal learning for stock prediction: Integrating financial statements and news. Knowledge-Based Systems, 235, 107629.
4. Hu, G., Hu, Y., Yang, K., Yu, Z., Sung, F., Zhang, Z., ... & Miemie, Q. (2018). Deep stock representation learning: From candlestick charts to investment decisions. In Proceedings of the IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP) (pp. 2706-2710).
5. Huang, C. Y., Chen, Y. S., & Huang, Y. L. (2020). Deep reinforcement learning with double Q-learning and prioritized experience replay for automated trading. Applied Intelligence, 50(11), 3915-3937.
6. Jiang, Z., Xu, D., & Liang, J. (2017). A deep reinforcement learning framework for the financial portfolio management problem. arXiv preprint arXiv:1706.10059.
7. Li, Y., Zheng, W., & Zheng, Z. (2019). Deep robust reinforcement learning for practical algorithmic trading. IEEE Access, 7, 108014-108022.
8. Lu, J., Batra, D., Parikh, D., & Lee, S. (2019). ViLBERT: Pretraining task-agnostic visiolinguistic representations for vision-and-language tasks. In Advances in Neural Information Processing Systems (pp. 13-23).
9. Xiong, Z., Liu, X. Y., Zhong, S., Yang, H., & Walid, A. (2018). Practical deep reinforcement learning approach for stock trading. arXiv preprint arXiv:1811.07522.
10. Yang, L., Xu, Z., & Shi, J. (2020). Dual sentiment analysis: Considering two sides of one review for sentiment classification. Knowledge-Based Systems, 204, 106236.
11. Zhang, L., Liu, C., & Zhu, H. (2020). Stock price prediction based on LSTM and attention mechanism. In Proceedings of the International Conference on Artificial Intelligence and Computer Science (pp. 416-420). 